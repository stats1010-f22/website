{
  "hash": "e09e6e55b6e14a7f8ea7be675b25abe5",
  "result": {
    "markdown": "---\ntitle: \"Chapter 6: Association between quantitative variables\"\nsubtitle: \"STAT 1010 - Fall 2022\"\nfooter:  \"[stat1010-f22.github.io/website](https://stats1010-f22.github.io/website/)\"\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\neditor: visual\nexecute:\n  freeze: auto\n---\n\n\n\n\n# Learning outcomes\n\n::: incremental\nBy the end of this lesson you should:\n\n-   Perform a visual association test\n\n-   Know how to read a scatterplot to describe associations between quantitative variables\n\n-   Know how to quantify associations in quantitative variables\n\n-   Use a line to describe associations in linear relationships\n\n-   Understand spurious correlations and lurking variables\n:::\n\n# Associations\n\n::: notes\nWhen have we used this word before?\n\nRemind them of $\\chi^2$ tests\n:::\n\n::: incremental\n-   $\\chi^2$ tests are used for associations in categorical data\n-   What is used to find associations in numeric data?\n:::\n\n# Plots\n\n::: notes\nRemind them about plots of proportions that we did for titanic and comics data. What did we look for in the plots?\n\nWhich variable goes on the y axis? Which on the x axis?\n:::\n\n::: incremental\n-   variable on the $y$ axis\n    -   dependent\n    -   response\n    -   outcome\n-   variable on the $x$ axis\n    -   independent\n    -   explanatory\n    -   predictor\n:::\n\n## Price vs carat\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/scatterplot-1.png){width=960}\n:::\n:::\n\n\n## Visual association test\n\n::: notes\nAsk them to run the coding in RStudio and see what they get - can connect some of their computers to the big screen\n\nCan they see a difference between their plots and the real plot? What is the difference?\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell .column-page-left context='server'}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/association_test_run-1.png){width=960}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell .column-page-right}\n\n```{.r .cell-code  code-line-numbers=\"|2|3|4|6\"}\ndiamonds %>% # filtered data\n  slice_sample(n = nrow(.)) %>% # random sample rows\n  pull(carat) %>% # take out the variable carat\n  bind_cols(., diamonds$price) %>% # price in the same order and bound to carat in different order\n  ggplot() + # into ggplot\n  geom_point(aes(y = ...2, x = ...1)) + # using the new names\n  labs(title = \"Simulated association test\", \n       x = \"Weight of diamond in carat\", \n       y = \"Price of diamonds in US$\")\n```\n:::\n\n:::\n:::\n\n#  {background-iframe=\"https://nzgwynn.shinyapps.io/shiny_apps/\"}\n\n## Describing a scatter plot\n\n::: notes\nWhat is the difference between the actual plot and the simulated plots?\n\nDiscuss each point.\n\nBig words make you sound smart to people that aren't that smart.\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n-   Trend or direction\n    -   positive\n    -   negative\n-   Curvature\n    -   linear\n    -   nonlinear\n        -   exponential\n        -   quadratic\n:::\n\n::: {.column width=\"50%\"}\n-   Variation\n    -   homoscedasticity (similar variance)\n    -   heteroscedasticity (different variance)\n-   Outliers\n    -   any weird points (explore these)\n-   Groupings\n:::\n:::\n\n## Describe these plots\n\n::: notes\nWhat are the relationships between each plot?\n\nWhat do the numbers mean?\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/pairs_plots-1.png){width=960}\n:::\n:::\n\n\n# Measuring association\n\n::: notes\nHow can we quantify this stuff?\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n![](lect-08_things/covariance_shift_means/price_moves.gif)\n:::\n\n::: {.column width=\"50%\"}\n![](lect-08_things/covariance_shift_means/carat_moves.gif)\n:::\n:::\n\n## Measuring association\n\n::: notes\nRemind them of the variance and what we did with the squares. What squares could we use now?\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/association_means-1.png){width=960}\n:::\n:::\n\n\n## Covariance\n\n::: notes\nIf the product is negative then there it contributes to a negative trend - downhill from left to right.\n\nSame if positive\n\nhard to get ones that are negative for this dataset b/c tbere is a really strong positive association\n:::\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/covariance_squares-1.png){width=960}\n:::\n:::\n\n\n## Covariance math\n\n::: notes\nThis is a measure of the squares. We'd like a measure that is one dimensional. We want to look at more than just squares.\n:::\n\n$cov(x, y) = \\frac{(x_1 - \\bar{x})(y_1 - \\bar{y}) + (x_2 - \\bar{x})(y_2 - \\bar{y}) + \\ldots + (x_n - \\bar{x})(y_n - \\bar{y})}{n-1}$\n\n## Correlation math\n\n::: notes\nStandardizes the strength of the association\n:::\n\n$$corr(x, y) = \\frac{cov(x, y)}{s_x \\cdot s_y}$$\n\n## Correlation characteristics\n\n::: notes\nStandardizes the strength of the association\n:::\n\n::: incremental\n1.  Referred to as $r$\n2.  Strength of linear association\n3.  $r$ is always between $-1$ and $+1$, $-1 \\leq r \\leq 1$.\n4.  $r$ does not have units\n:::\n\n##  {background-image=\"lect-08_things/correlation_coef.png\" background-size=\"contain\"}\n\n## Computing in `R`\n\n::: notes\nStandardizes the strength of the association\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# covariance of price and carat\ncov(diamonds$price, diamonds$carat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1742.765\n```\n:::\n\n```{.r .cell-code}\n# correlation of price and carat\ncor(diamonds$price, diamonds$carat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9215913\n```\n:::\n\n```{.r .cell-code}\n# coding for the pairs plots\n# library(GGally)\n# diamonds %>% # dataset\n#  select_if(is.numeric) %>% # numeric variables\n#  filter(y < 20, # y less than 20\n#         z < 20, # z less than 20\n#         table < 90) %>% # table less than 90\n#  ggpairs(.) # make the plot\n```\n:::\n\n\n# Line of association\n\n::: notes\nWhat do these numbers mean?\n:::\n\n$$ y = mx + b $$\n\n::: incremental\n-   $m$ is gradient $b$ is the $y$ intercept\n:::\n\n## Gradient and slope\n\n::: notes\nPull out your calculators and work on this\n:::\n\n$$ m = \\frac{r \\cdot s_y}{s_x} $$ $$ b = \\bar{y} - m \\bar{x} $$\n\n## Fitting by hand\n\n::: incremental\n-   $r = 0.9215913$\n\n-   $s_{price} = 3989.44$\n\n-   $s_{carat} = 0.4740112$\n\n-   $m = \\frac{r \\cdot s_{price}}{s_{carat}}$\n\n-   $$\\begin{aligned}\n       m &= \\frac{r \\cdot s_{price}}{s_{carat}} \\\\\n    &= \\frac{0.9215913 \\cdot 3989.44}{0.4740112} \\\\\n    &= 7756.426\n    \\end{aligned}$$\n:::\n\n## Fitting by hand\n\n::: incremental\n-   $b = \\overline{price} - m \\cdot \\overline{carat}$\n\n-   $\\overline{price} = 3932.8$\n\n-   $\\overline{carat} = 0.7979397$\n\n-   $m = 7756.426$\n\n-   $$\\begin{aligned}\n    b &= \\overline{price} - m \\cdot \\overline{carat} \\\\\n    &= 3932.8 - 7756.426 \\cdot 0.7979397\\\\\n    &= -2256.36\n    \\end{aligned}$$\n\n-   Our model is: $\\widehat{\\text{price}} = -2256.36 + 7756.426 \\cdot \\text{carat}$\n:::\n\n## Prediction by hand\n\n::: notes\nPull out your calculators and work on this\n:::\n\nfor carat values $2.5$\n\n::: incremental\n-   $\\widehat{\\text{price}} = -2256.36 + 7756.426 \\cdot \\text{carat}$\n\n-   $$\\begin{aligned}\n    \\widehat{\\text{price}}  &= -2256.36 + 7756.426 \\cdot \\text{carat} \\\\ \n    &= -2256.36 + 7756.426 \\cdot 2.5 \\\\\n    &= \\$17135\n    \\end{aligned}$$\n:::\n\n## Fit & predict in `R`\n\n::: notes\nfirst use of tidymodels package\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2|6|7|8|9|13\"}\n# library tidymodels\nlibrary(tidymodels)\n\n## Assign the least\n## squares line\nleast_squares_fit <- \n  linear_reg() %>% \n  set_engine(\"lm\") %>% \n  fit(price ~ carat, data = diamonds) \n## NOTE: outcome first, predictor second\n\n## Find the prediction\npredict(least_squares_fit, tibble(carat = c(1, 2, 2.5, 4)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 Ã— 1\n   .pred\n   <dbl>\n1  5500.\n2 13256.\n3 17135.\n4 28769.\n```\n:::\n:::\n\n\n## Warnings\n\n::: incremental\n-   ALWAYS draw plots first\n-   numeric variables\n-   Linear relationship\n-   Check for outliers\n-   Lurking variables\n:::\n\n# Spurious correlations\n\n::: incremental\n-   100% of people who eat ketchup die\n-   amount of sunscreen used and probability of getting skin cancer\n-   birth order and probability of down syndrome\n-   countries with more smokers also have higher life expectancy\n-   More shark attacks are associated with higher levels of ice cream sales.\n-   The more volunteers at a natural disaster, the more destruction\n:::\n\n## More spurious correlations\n\n::: incremental\n-   These variables are called lurking variables or confounders.\n\n-   Lurking variables are not considered in the statistical analysis\n\n-   Confounders are considered\n\n-   There are both known and unknown confounders, uknown confounders are lurking variables.\n:::\n\n[Click here](https://www.tylervigen.com/spurious-correlations) for more spurious correlations\n\n# Your turn\n\n[Click here](https://stats1010-f22.github.io/website/ae/ae-9.html) or the qr code below\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_08_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "lect_08_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    function fireSlideChanged(previousSlide, currentSlide) {\n\n      // dispatch for htmlwidgets\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for reveal\n    if (window.Reveal) {\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\n        fireSlideChanged(event.previousSlide, event.currentSlide);\n      });\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}