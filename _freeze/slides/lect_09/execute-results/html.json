{
  "hash": "66dfb6810942792d3efb47f877edc182",
  "result": {
    "markdown": "---\ntitle: \"Chapter 10: Association between random variables\"\nsubtitle: \"STAT 1010 - Fall 2022\"\nfooter:  \"[stat1010-f22.github.io/website](https://stats1010-f22.github.io/website/)\"\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\neditor: visual\nexecute:\n  freeze: auto\n---\n\n\n\n\n# Learning outcomes {.smaller}\n\n::: incremental\nBy the end of this lesson you should:\n\n-   Understand the Sharpe ratio and know how to compute it to compare stocks that are not independent\n-   Understand and use a joint probability distribution function\n-   Know the 3 rules of independence\n-   Understand how covariance, correlation, and independence intertwine\n-   Explain how independent and identically distributed random variables impact upon expectation, variance, and standard deviation\n-   Compute expectation and variance of weighted sums\n:::\n\n# Revision 1\n\n::: notes\none of the main differences between this and chpt 6, is that here we are dealing with a population, before we were dealing with a sample.\n\nStress this throughout the class.\n:::\n\n![](lect_07-images/parameter_estimate.png)\n\n# The Sharpe Ratio\n\n::: notes\nwrite S(X) formula on the board\n\noften mu and sigma are unknown parameters\n\nAlso, do we want the Sharpe ratio to be high or low?\n:::\n\n$$S(X) = \\frac{\\mu_X - r_f}{\\sigma_X}$$\n\n::: incremental\n-   $r_f$ is the return on a risk-free investment\n-   $\\mu$ is the mean of a random variable $X$ that measures the performance of an investment\n-   $\\sigma$ is the standard deviation of a random variable $X$ that measures the performance of an investment\n-   all inputs must be measured over the same time period (ie. yearly, monthly, ...)\n:::\n\n## Compute the Sharpe ratio\n\n::: notes\nhave them go back to the previous slide and see what they got\n:::\n\n| Company   | Random Variable | Mean per month | SD    |\n|-----------|-----------------|----------------|-------|\n| Apple     | A               | 2.45%          | 13.3% |\n| McDonalds | M               | 1.14%          | 6.2%  |\n\nassume $r_f$ is the risk-free rate of interest is $0.1\\%$\n\n## Compute the Sharpe ratio\n\n::: notes\nwork through it, then what if we don't know mu and sigma could we find it if we had a pdf?\n:::\n\n::: columns\n::: {.column width=\"50%\"}\n::: incremental\n-   $$\\begin{aligned}\n    S(A) &= \\frac{\\mu_A - r_f}{\\sigma_A}\\\\\n    &= \\frac{2.45 - 0.1}{13.3}\\\\\n    &=  0.177\n    \\end{aligned}$$\n\n-   $$\\begin{aligned}\n    S(M) &= \\frac{\\mu_M - r_f}{\\sigma_M}\\\\\n    &= \\frac{1.14 - 0.1}{6.2}\\\\\n    &=  0.168\n    \\end{aligned}$$\n:::\n:::\n\n::: {.column width=\"50%\"}\nWe prefer Apple because it has a higher Sharpe ratio $0.177 > 0.168$\n:::\n:::\n\n## Revision 2\n\n::: notes\nfind the mean, stdev, and use them to find the Sharpe ratio\n\nput microsoft is y on the board and IBM is x\n\ncopy down the means and st deviation when they get them\n:::\n\nInstead of knowing $\\mu$ and $\\sigma$ we have a pdf\n\n|           | IBM stock | IBM stock  | Microsoft | Microsoft  |\n|-----------|-----------|------------|-----------|------------|\n|           | $x$       | $P(X = x)$ | $y$       | $P(Y = y)$ |\n| Increases | \\$5       | 0.11       | \\$4       | 0.18       |\n| No change | 0         | 0.80       | 0         | 0.67       |\n| Decreases | -\\$5      | 0.09       | -\\$4      | 0.15       |\n\n## Sharpe ratio by hand {.smaller}\n\n|           | IBM  | IBM        | IBM     | IBM                        | IBM      | IBM     | IBM          |\n|---------|---------|---------|---------|---------|---------|---------|---------|\n|           | $x$  | $P(X = x)$ | $\\mu_X$ | $(x-\\mu_X)^2 \\cdot p_X(x)$ | $Var(X)$ | $sd(X)$ | Sharpe ratio |\n| Increases | \\$5  | 0.11       |         |                            |          |         |              |\n| No change | 0    | 0.80       |         |                            |          |         |              |\n| Decreases | -\\$5 | 0.09       |         |                            |          |         |              |\n\n## Sharpe ratio by hand {.smaller}\n\n|           | IBM  | IBM        | IBM     | IBM                        | IBM      | IBM     | IBM          |\n|---------|---------|---------|---------|---------|---------|---------|---------|\n|           | $x$  | $P(X = x)$ | $\\mu_X$ | $(x-\\mu_X)^2 \\cdot p_X(x)$ | $Var(X)$ | $sd(X)$ | Sharpe ratio |\n| Increases | \\$5  | 0.11       | 0.1     | 2.6411                     | 4.99     | 2.23    | 0.03805123   |\n| No change | 0    | 0.80       | 0.1     | 0.0080                     | 4.99     | 2.23    | 0.03805123   |\n| Decreases | -\\$5 | 0.09       | 0.1     | 2.3409                     | 4.99     | 2.23    | 0.03805123   |\n\n## Sharpe ratio by hand {.smaller}\n\n|           | MCSFT | MCSFT     | MCSFT   | MCSFT                      | MCSFT    | MCSFT   | MCSFT        |\n|---------|---------|---------|---------|---------|---------|---------|---------|\n|           | $y$   | $P(Y =y)$ | $\\mu_Y$ | $(y-\\mu_Y)^2 \\cdot p_Y(y)$ | $Var(Y)$ | $sd(Y)$ | Sharpe ratio |\n| Increases | \\$4   | 0.18      |         |                            |          |         |              |\n| No change | 0     | 0.67      |         |                            |          |         |              |\n| Decreases | -\\$4  | 0.15      |         |                            |          |         |              |\n\n## Sharpe ratio by hand {.smaller}\n\n|           | MCSFT | MCSFT     | MCSFT   | MCSFT                      | MCSFT    | MCSFT   | MCSFT        |\n|---------|---------|---------|---------|---------|---------|---------|---------|\n|           | $y$   | $P(Y =y)$ | $\\mu_Y$ | $(y-\\mu_Y)^2 \\cdot p_Y(y)$ | $Var(Y)$ | $sd(Y)$ | Sharpe ratio |\n| Increases | \\$4   | 0.18      | 0.12    | 2.709792                   | 5.2656   | 2.29469 | 0.04575782   |\n| No change | 0     | 0.67      | 0.12    | 0.009648                   | 5.2656   | 2.29469 | 0.04575782   |\n| Decreases | -\\$4  | 0.15      | 0.12    | 2.546160                   | 5.2656   | 2.29469 | 0.04575782   |\n\n## The Sharpe ratio - in `R`\n\n::: notes\nCan an investor do better by diversifing the investment?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Input the data and the pdf\nstock <- tibble(x = c(5, 0, -5), \n                p_x = c(0.11, 0.8, 0.09), \n                y = c(4, 0, -4), \n                p_y = c(.18, .67, .15))\n\n\nSharpe_ratio <- # name this the Sharpe ratio\n  stock %>% # use the data from above\n  mutate(part_mean_x = x*p_x, # find mean for each part of x \n         part_mean_y = y*p_y, # now for y\n         mean_x = sum(part_mean_x), # find mean x \n         mean_y = sum(part_mean_y),# now for y\n         part_var_x = p_x * (mean_x - x)^2, # find var for each part of x \n         part_var_y = p_y * (mean_y - y)^2,# now for y\n         var_x = sum(part_var_x), # find var of x \n         var_y = sum(part_var_y),# now for y\n         sd_x = sqrt(var_x), # find sd of x \n         sd_y = sqrt(var_y)) %>% # now for y\n  summarise(S_x = (mean_x - 0.015)/sd_x, # find Sharpe ratio of x with rf = 0.015\n            S_y = (mean_y - 0.015)/sd_y) %>% # now for y\n  slice(1)\n```\n:::\n\n\n# Joint probability distributions {.smaller}\n\n::: notes\nWhat is the expected value of X + Y?\n\nWhen you see two random variables you first want to think independence.\n\nAre these variables independent or not?\n:::\n\n::: column-margin\n|     |        | $X$      | $X$     | $X$     |        |\n|-----|--------|----------|---------|---------|--------|\n|     |        | $x = -5$ | $x = 0$ | $x = 5$ | $p(y)$ |\n| $Y$ | $y=4$  | $0.00$   | $0.11$  | $0.07$  | $0.18$ |\n| $Y$ | $y=0$  | $0.03$   | $0.62$  | $0.02$  | $0.67$ |\n| $Y$ | $y=-4$ | $0.06$   | $0.07$  | $0.02$  | $0.15$ |\n|     | $p(x)$ | $0.09$   | $0.80$  | $0.11$  | $1$    |\n:::\n\n::: incremental\n-   What is the probability that $x = 0$ and $y =4$? - $11\\%$\n\n-   What is the probability that $x = 5$ and $y =4$? - $7\\%$\n\n-   What is the probability that $x = 0$ and $y =0$? - $62\\%$\n\n-   What outcome will never occur? - $x = -5$ and $y =4$\n:::\n\n## Expected value of $X + Y$\n\n::: notes\nIf x=-5 then we subtract 5 from all y's and multiply by $p_{x, y}$ algebraically it all washes out\n\nWhat about independence? We want to find the standard deviation to compute the Sharpe Ratio\n:::\n\n|     |        | $X$      | $X$     | $X$     |        |\n|-----|--------|----------|---------|---------|--------|\n|     |        | $x = -5$ | $x = 0$ | $x = 5$ | $p(y)$ |\n| $Y$ | $y=4$  | $0.00$   | $0.11$  | $0.07$  | $0.18$ |\n| $Y$ | $y=0$  | $0.03$   | $0.62$  | $0.02$  | $0.67$ |\n| $Y$ | $y=-4$ | $0.06$   | $0.07$  | $0.02$  | $0.15$ |\n|     | $p(x)$ | $0.09$   | $0.80$  | $0.11$  | $1$    |\n\n::: incremental\n-   $E(X+Y) = E(X) + E(Y)$\n-   $E(X+Y) = E(X) + E(Y) = 0.1 + 0.12 = 0.22$\n:::\n\n# 3 Rules of independence\n\n::: notes\nSo are X and Y independent?\n:::\n\nIf the probability of one event occuring has no impact on another event occuring, they are independent.\n\n::: incremental\n-   If $X$ and $Y$ are independent then $p(x,y) = p(x) \\cdot p(y)$ for all pairs $(x,y)$\n\n-   If $p(x,y) = p(x) \\cdot p(y)$ for all $(x, y)$ pairs, then $X$ and $Y$ are independent.\n\n-   It follows that if $X$ and $Y$ are independent, then $E(XY) = E(X) \\cdot E(Y)$\n:::\n\n## Are $X$ and $Y$ independent?\n\n::: notes\nfind any p(x) X p(y) != p(x,y)\n\nBut we still need to find the stdev in order to find Sharpes ratio\n:::\n\n|     |        | $X$      | $X$     | $X$     |        |\n|-----|--------|----------|---------|---------|--------|\n|     |        | $x = -5$ | $x = 0$ | $x = 5$ | $p(y)$ |\n| $Y$ | $y=4$  | $0.00$   | $0.11$  | $0.07$  | $0.18$ |\n| $Y$ | $y=0$  | $0.03$   | $0.62$  | $0.02$  | $0.67$ |\n| $Y$ | $y=-4$ | $0.06$   | $0.07$  | $0.02$  | $0.15$ |\n|     | $p(x)$ | $0.09$   | $0.80$  | $0.11$  | $1$    |\n\n::: incremental\n-   $p_x(-5) \\cdot p_y(4) = 0.18 \\cdot 0.09 \\neq 0.00$\n\n-   $p_x(-5) \\cdot p_y(-4) = 0.09 \\cdot 0.15 = 0.0135 \\neq 0.06$\n\n-   NO! NO! NO!\n:::\n\n# Covariance of Random Variables\n\n::: notes\nlast lesson (chpt 6) assumes that each $(x, y)$ pair appears once and are equally weighted\n:::\n\n::: incremental\n-   $cov(x, y) = \\frac{(x_1 - \\bar{x})(y_1 - \\bar{y}) + (x_2 - \\bar{x})(y_2 - \\bar{y}) + \\ldots + (x_n - \\bar{x})(y_n - \\bar{y})}{n-1}$\n\n-   assumes each $(x, y)$ pair appears once\n\n-   $$Cov(X, Y) = E((X - \\mu_X)(Y - \\mu_Y))$$\n:::\n\n## Covariance of sum\n\n::: notes\nbecause we square things and $(a + b)^2 = a^2 + b^2 + 2ab$ we have to add 2 of the covariance\n:::\n\n::: incremental\n-   $(a+b)^2 = a^2 + 2ab +b^2$\n-   it follows that\n-   $Var(X + Y) = Var(X) + Var(Y) + 2Cov(X, Y)$\n:::\n\n## Correlation {.smaller}\n\n::: notes\nwhat about our joint pdf? is it positively or negatively correlated? 3D plot\n:::\n\n::: incremental\n-   $corr(x, y) = \\frac{cov(x, y)}{s_x \\cdot s_y}$\n\n-   $$\\rho = Corr(X, Y) = \\frac{Cov(X, Y)}{\\sigma_X \\cdot \\sigma_Y}$$\n\nAs $X$ increases, what happens to $Y$?\n:::\n\n::: column-margin\n|     |        | $X$      | $X$     | $X$     |        |\n|-----|--------|----------|---------|---------|--------|\n|     |        | $x = -5$ | $x = 0$ | $x = 5$ | $p(y)$ |\n| $Y$ | $y=4$  | $0.00$   | $0.11$  | $0.07$  | $0.18$ |\n| $Y$ | $y=0$  | $0.03$   | $0.62$  | $0.02$  | $0.67$ |\n| $Y$ | $y=-4$ | $0.06$   | $0.07$  | $0.02$  | $0.15$ |\n|     | $p(x)$ | $0.09$   | $0.80$  | $0.11$  | $1$    |\n:::\n\n## Independence & Cov\n\nHow does independence impact upon correlation and covariance?\n\n$$ E((X-\\mu_X)(Y-\\mu_Y))$$\n\n::: incremental\n-   $$\\begin{aligned}\n    Cov(X,Y) &= E((X-\\mu_X)(Y-\\mu_Y))\\\\\n    &= E(X - \\mu_X)E(Y-\\mu_Y)\\\\\n    &= 0\n    \\end{aligned}$$\n\n-   If $X$,$Y$ are independent, then $Cov(X, Y) = 0$\n\n-   The opposite is not true (if $Cov(X, Y) = 0$, then $X$,$Y$ are independent)\n:::\n\n## Independence & Var\n\n$Var(X) + Var(Y) = Var(X) + Var(Y) + 2Cov(X, Y)$\n\n::: incremental\n-   If $X$, $Y$ are independent, $Cov(X, Y) = 0$, so\n\n-   $$Var(X+ Y) = Var(X) + Var(Y)$$\n:::\n\n## Sharpe ratio of a sum\n\n$$ S(X + Y) = \\frac{(\\mu_X + \\mu_Y) - 2r_f}{\\sqrt{(Var(X+Y))}} $$\n\n## Sharpe ratio of sum - R\n\n::: notes\nWhat if we want to invest in two subsequent days instead of investing in two stocks for 1 day?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-line-numbers=\"|2|6|10|22\"}\n# input x & y\nx <- c(-5, 0, 5)\ny <- c(4, 0, -4)\n\n# input data\ndata <- bind_cols(expand_grid(x, y), \n                  probs = c(0, .03, .06, \n                            .11, .62, .07, \n                            .07, .02, .02), \n                  mu_x = rep(0.1, 9), \n                  mu_y = rep(0.12, 9), \n                  var_x = rep(4.99, 9), \n                  var_y = rep(5.2656, 9))\n\ndata %>% \n  mutate(cov_xy_part = (x - mu_x)*\n           (y - mu_y)*probs, # multiply together\n         cov_xy = sum(cov_xy_part), # sum them\n         var_xy = var_x + var_y + 2*cov_xy) %>% # using the rule\n  summarise(S_r = (mu_x + mu_y - 2*0.015)/\n                      (sqrt(var_xy))) %>% # find the Sharpe value\n  slice(1) # only the first\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 Ã— 1\n     S_r\n   <dbl>\n1 0.0497\n```\n:::\n:::\n\n\n::: incremental\n-   The Sharpe ratio for $X$ is $0.038$, for $Y$ it's $0.046$, investing in both gives a better return $0.050$\n:::\n\n# Double the investment\n\n::: incremental\n-   Invest twice as much for one day\n-   Invest in one stock for two subsequent days\n-   Which is better? Why?\n:::\n\n## Double for one day {.smaller}\n\n$$S(2X) = \\frac{2\\mu_X - 2r_f}{\\sqrt{Var(2X)}}$$\n\n::: incremental\n-   $\\mu_X = 0.1$\n\n-   $Var(X) = 4.99$\n\n-   $r_f = .015$\n\n-   $$\\begin{aligned}\n      &= \\frac{2 \\cdot 0.1 - 2 \\cdot 0.015}{\\sqrt{4 \\cdot 4.99}}\\\\\n      &= \\frac{.2 - 0.03}{\\sqrt{19.96}}\\\\\n      &= 0.038\n      \\end{aligned}$$\n\n-   This is the same as before, how do we compute if we invest for two subsequent days?\\\n:::\n\n## IID {.smaller}\n\nIf we invested in a stock on 2 subsequent days instead of investing in 2 stocks on one day the return on those two days are:\n\n**i**ndependent and **i**dentically **d**istributed (IID)\n\n::: incremental\n-   identically distributed - the outcomes on each day are likely to be different, but the probability of the outcomes is the same\n\n-   independent - very common assumption for stocks (part of the reason for the 2008 financial crises)\n:::\n\n## Addition rules for IID variables\n\n::: callout-important\nIf $n$ random variables $(X_1, X_2, ..., X_n)$ are iid with mean $\\mu_X$ and standard deviation $\\sigma_X$, then\n\n$$ E(X_1 + X_2 + ... + X_n) = n \\cdot \\mu_X $$ $$ Var(X_1 + X_2 + ... + X_n) = n \\cdot \\sigma^2_x $$ $$ SD(X_1 + X_2 + ... + X_n) = \\sqrt{n} \\sigma_X $$\n:::\n\n## Sharpe ratio - two days {.smaller}\n\n::: notes\nif you decide to leave money in the bank, you may end up with a constant\n:::\n\n$$ S(X_1 + X_2) = \\frac{2\\mu_X - 2r_f}{\\sqrt{2 \\sigma^2_x}}$$\n\n::: incremental\n-   $$\\begin{aligned}\n    &= \\frac{0.20 - 0.03}{\\sqrt{9.98}}\\\\\n    &= 0.054\n    \\end{aligned}$$\n-   you expect more variance if you have two stock for one day b/c anything that happens that day is magnified\n-   if you have one stock for two days you reduce the variance\n:::\n\n# Weighted sums\n\nIf we decide to leave money in the bank, there will be interest that accrues. How can we include this in our model?\n\n::: callout-important\n$$E(aX + bY + c) = aE(X) + bE(Y) + c$$\n\n$$Var(aX + bY + c) = a^2Var(X) + b^2Var(Y) + 2abCov(X, Y)$$\n:::\n\n## Expectation of weighted sum\n\n$$ E(2X + 4Y + 0.06)$$\n\n::: incremental\n-   \n\n    -   $$\\begin{aligned}\n        &= 2E(X) + 4E(Y) + 0.06\\\\\n        &= 2(0.10) + 4(0.12) + 0.06\\\\\n        &= \\$0.74\n        \\end{aligned}$$\n:::\n\n## Variance of weighted sum\n\n$$ Var(2X + 4Y + 0.06)$$\n\n::: incremental\n-   $$\\begin{aligned}\n    &= 2^2Var(X) + 4^2Var(Y) + 2 \\cdot(2 \\cdot 4) \\cdot Cov(X,Y)\\\\\n    &= 4(4.99) + 16(5.27) + 16(2.19)\\\\\n    &= 139.32\n    \\end{aligned}$$\n:::\n\n# Your turn\n\n[Click here](https://stats1010-f22.github.io/website/ae/ae-9.html) or the qr code below\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lect_09_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "lect_09_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    function fireSlideChanged(previousSlide, currentSlide) {\n\n      // dispatch for htmlwidgets\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for reveal\n    if (window.Reveal) {\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\n        fireSlideChanged(event.previousSlide, event.currentSlide);\n      });\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}